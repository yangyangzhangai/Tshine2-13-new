# Time Shine - éœ€æ±‚æ–‡æ¡£

> åŠŸèƒ½éœ€æ±‚ã€æŠ€æœ¯è§„æ ¼ä¸å¼€å‘è·¯çº¿å›¾

---

## ğŸ“‹ æ–‡æ¡£è¯´æ˜

- **æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0
- **æœ€åæ›´æ–°**ï¼š2026-02-15
- **é€‚ç”¨èŒƒå›´**ï¼šå‰ç«¯å¼€å‘ã€AI é›†æˆã€UI/UX è®¾è®¡
- **å…³è”æ–‡æ¡£**ï¼šPROJECT_OVERVIEW.mdï¼ˆäº§å“æ¦‚è¿°ï¼‰ã€ARCHITECTURE.mdï¼ˆæŠ€æœ¯æ¶æ„ï¼‰

---

## ğŸ¯ åŠŸèƒ½éœ€æ±‚æ€»è§ˆ

### æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Time Shine                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   è®°å½•ç³»ç»Ÿ    â”‚   ç¢ç‰‡ç³»ç»Ÿ    â”‚   AI æ‰¹æ³¨    â”‚   ç”»å»Šç³»ç»Ÿ     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ å¯¹è¯æ¨¡å¼    â”‚ â€¢ ç¢ç‰‡ç”Ÿæˆ    â”‚ â€¢ äº‹ä»¶ç›‘å¬   â”‚ â€¢ æ—¥å½©çª—       â”‚
â”‚ â€¢ è®°å½•æ¨¡å¼    â”‚ â€¢ å±æ€§è®¡ç®—    â”‚ â€¢ å†³ç­–å¼•æ“   â”‚ â€¢ å‘¨/æœˆæ‹¼å›¾    â”‚
â”‚ â€¢ å¿ƒæƒ…è®°å½•    â”‚ â€¢ AI è§†è§‰å†³ç­– â”‚ â€¢ æ‰¹æ³¨å±•ç¤º   â”‚ â€¢ å†å²æµè§ˆ     â”‚
â”‚ â€¢ æ´»åŠ¨è®¡æ—¶    â”‚              â”‚              â”‚ â€¢ å½±å­æ—¥è®°     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1ï¸âƒ£ è®°å½•ç³»ç»Ÿ (Recording System)

### 1.1 å¯¹è¯/è®°å½•åŒæ¨¡å¼

**ç°æœ‰åŠŸèƒ½**ï¼ˆå·²éªŒè¯ï¼‰ï¼š
- âœ… Chat æ¨¡å¼ï¼šè‡ªç”±å¯¹è¯ï¼ŒAI å›å¤
- âœ… Record æ¨¡å¼ï¼šæ´»åŠ¨è®°å½•ï¼Œè‡ªåŠ¨è®¡ç®—æ—¶é•¿
- âœ… å¿ƒæƒ…æ¨¡å¼ï¼šç²‰è‰²ä¸»é¢˜ï¼Œè®°å½•æƒ…ç»ª

**éœ€æ±‚å˜æ›´**ï¼š
- âŒ Chat æ¨¡å¼çš„ AI å›å¤åŠŸèƒ½**ç§»é™¤**
- âœ… AI ä»…é€šè¿‡æ‰¹æ³¨ç³»ç»Ÿä¸ç”¨æˆ·äº¤äº’

### 1.2 æ´»åŠ¨è®°å½•æµç¨‹

```
ç”¨æˆ·è¿›å…¥ Record æ¨¡å¼
    â†“
è¾“å…¥æ´»åŠ¨åç§°ï¼ˆå¦‚"å†™ä»£ç "ï¼‰
    â†“
ç³»ç»Ÿè‡ªåŠ¨è®¡æ—¶
    â†“
ç”¨æˆ·è¾“å…¥ä¸‹ä¸€ä¸ªæ´»åŠ¨æˆ–åˆ‡æ¢æ¨¡å¼
    â†“
è‡ªåŠ¨è®¡ç®—ä¸Šä¸€æ´»åŠ¨æ—¶é•¿
    â†“
ç”Ÿæˆæ´»åŠ¨è®°å½•
    â†“
è§¦å‘ç¢ç‰‡ç”Ÿæˆæµç¨‹
```

**æ•°æ®æ¨¡å‹**ï¼ˆå·²æœ‰ï¼Œéœ€æ‰©å±•ï¼‰ï¼š
```typescript
interface Message {
  id: string;
  content: string;        // æ´»åŠ¨å†…å®¹
  timestamp: number;      // å¼€å§‹æ—¶é—´
  duration?: number;      // æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
  type: 'text' | 'ai' | 'system';
  mode: 'chat' | 'record';
  isMood?: boolean;       // æ˜¯å¦ä¸ºå¿ƒæƒ…è®°å½•
  
  // æ–°å¢ï¼šå…³è”ç¢ç‰‡
  fragmentId?: string;    // å…³è”çš„ç¢ç‰‡ ID
}
```

### 1.3 å¾…åŠå¿«æ·å…¥å£

**éœ€æ±‚**ï¼šåœ¨é¦–é¡µ/å¾…åŠé¡µé¢é¡¶éƒ¨æ·»åŠ ç½®é¡¶å»ºè®®å¡ç‰‡

```typescript
interface QuickAction {
  id: string;
  icon: string;           // emoji å›¾æ ‡
  text: string;           // æ“ä½œæ–‡å­—
  target: '/todo' | '/chat' | '/gallery';
  priority: 'high' | 'normal';
}

// é»˜è®¤æ˜¾ç¤º
{
  icon: 'ğŸ¯',
  text: 'å¼€å§‹å®Œæˆä»Šæ—¥å¾…åŠ',
  target: '/todo',
  priority: 'high'
}
```

---

## 2ï¸âƒ£ ç¢ç‰‡ç³»ç»Ÿ (Fragment System)

### 2.1 ç¢ç‰‡ç”Ÿæˆæ—¶æœº

**è§¦å‘æ¡ä»¶**ï¼š
- è®°å½•æ¨¡å¼ä¸‹ï¼Œæ´»åŠ¨å®Œæˆæ—¶ï¼ˆduration è¢«è®¡ç®—åï¼‰
- å¿ƒæƒ…æ¨¡å¼ä¸‹ï¼Œå¿ƒæƒ…è®°å½•æäº¤æ—¶

**éè§¦å‘æ¡ä»¶**ï¼š
- å¾…åŠäº‹é¡¹å®Œæˆï¼ˆä¸ç›´æ¥ç”Ÿæˆç¢ç‰‡ï¼‰
- æ‰‹åŠ¨ç¼–è¾‘çš„æ´»åŠ¨è®°å½•ï¼ˆå¯é€‰ç”Ÿæˆï¼‰

### 2.2 ç¢ç‰‡æ•°æ®æ¨¡å‹

```typescript
interface TimeFragment {
  id: string;
  
  // å…³è”ä¿¡æ¯
  messageId: string;      // å…³è”çš„æ´»åŠ¨è®°å½• ID
  userId: string;
  
  // æ—¶é—´ä¿¡æ¯
  createdAt: number;      // ç¢ç‰‡ç”Ÿæˆæ—¶é—´
  activityDate: string;   // æ‰€å±æ—¥æœŸ YYYY-MM-DD
  
  // AI å†³å®šçš„è§†è§‰å±æ€§ï¼ˆæ ¸å¿ƒï¼‰
  shape: 'spiral' | 'arrow' | 'spark' | 'wave' | 'crystal';
  colorStart: string;     // æ¸å˜è‰²èµ·ç‚¹ï¼Œå¦‚ '#FF6B35'
  colorEnd: string;       // æ¸å˜è‰²ç»ˆç‚¹ï¼Œå¦‚ '#F7931E'
  texture: 'heavy' | 'light' | 'flowing' | 'explosive' | 'solid';
  temperature: 'cool' | 'warm' | 'hot' | 'electric';
  
  // å…ƒæ•°æ®ï¼ˆAI å‚è€ƒç”¨ï¼‰
  metadata: {
    activityContent: string;    // æ´»åŠ¨å†…å®¹
    duration: number;           // æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
    hourOfDay: number;          // å‘ç”Ÿæ—¶æ®µ 0-23
    isMood: boolean;            // æ˜¯å¦ä¸ºå¿ƒæƒ…
    moodContent?: string;       // å¿ƒæƒ…å†…å®¹ï¼ˆå¦‚æœæ˜¯å¿ƒæƒ…ï¼‰
  }
}
```

### 2.3 AI ç¢ç‰‡ç”Ÿæˆ API

**è¯·æ±‚æ ¼å¼**ï¼š
```typescript
interface FragmentGenerationRequest {
  date: string;              // YYYY-MM-DD
  activities: Array<{
    id: string;
    content: string;
    duration: number;
    timestamp: number;
    isMood: boolean;
    moodContent?: string;
  }>;
  dayContext: {
    totalActivities: number;
    totalDuration: number;     // æ€»æ´»åŠ¨æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
    activeHours: number[];     // æ´»è·ƒæ—¶æ®µ
    moodDistribution: string[]; // å¿ƒæƒ…å…³é”®è¯
  };
}
```

**å“åº”æ ¼å¼**ï¼š
```typescript
interface FragmentGenerationResponse {
  themeDescription: string;  // æ—¥ä¸»é¢˜æè¿°ï¼Œå¦‚"åœ¨æ˜Ÿç©ºä¸‹æ‰“ç›¹çš„çŒ«"
  fragments: Array<{
    activityId: string;
    shape: TimeFragment['shape'];
    colorStart: string;
    colorEnd: string;
    texture: TimeFragment['texture'];
    temperature: TimeFragment['temperature'];
    aiReasoning: string;       // AI å†³ç­–ç†ç”±ï¼ˆè°ƒè¯•ç”¨ï¼‰
  }>;
}
```

**API è°ƒç”¨æ—¶æœº**ï¼š
- ç­–ç•¥ Aï¼šå®æ—¶ç”Ÿæˆï¼ˆæ¯ä¸ªæ´»åŠ¨å®Œæˆåç«‹å³è°ƒç”¨ AIï¼‰
- ç­–ç•¥ Bï¼šæ‰¹é‡ç”Ÿæˆï¼ˆæ—¥ç»ˆç»Ÿä¸€ç”Ÿæˆï¼Œæ¨èï¼‰âœ…

---

## 3ï¸âƒ£ AI æ‰¹æ³¨ç³»ç»Ÿ (AI Annotation System)

### 3.1 æ ¸å¿ƒåŸåˆ™

- **äº‹ä»¶é©±åŠ¨**ï¼šç”¨æˆ·è¡Œä¸ºè§¦å‘ï¼Œè€Œéå®šæ—¶è½®è¯¢
- **AI å†³ç­–**ï¼šæ˜¯å¦æ‰¹æ³¨ã€æ‰¹æ³¨å†…å®¹ç”± AI å†³å®šï¼Œéè§„åˆ™å¼•æ“
- **é™åˆ¶æœºåˆ¶**ï¼šå†·å´æ—¶é—´ + æ¯æ—¥é™é¢ï¼Œé¿å…è¿‡åº¦æ‰“æ‰°

### 3.2 äº‹ä»¶è§¦å‘ç‚¹

| äº‹ä»¶ç±»å‹ | è§¦å‘æ—¶æœº | åŸºç¡€æ¦‚ç‡ | åŠ æˆæ¡ä»¶ |
|---------|---------|---------|---------|
| activity_completed | æ´»åŠ¨å®Œæˆæ—¶ | 30% | æ·±å¤œ(+20%)ã€è¿ç»­å®Œæˆ(+10%) |
| activity_recorded | è®°å½•æ–°æ´»åŠ¨æ—¶ | 15% | åå­—æœ‰è¶£(+15%) |
| mood_recorded | è®°å½•å¿ƒæƒ…æ—¶ | 20% | - |
| task_deleted | åˆ é™¤å¾…åŠæ—¶ | 25% | è¿ç»­åˆ é™¤(+20%) |
| idle_detected | 3å°æ—¶æ— æ“ä½œ | 30% | æ·±å¤œ(+15%) |
| overwork_detected | å·¥ä½œè¶…3hæ— ä¼‘æ¯ | 50% | - |
| day_complete | å®Œæˆå½“å¤©æœ€åä»»åŠ¡ | 60% | - |

### 3.3 æ‰¹æ³¨çŠ¶æ€ç®¡ç†

```typescript
interface AIAnnotationState {
  lastSpeakTime: number;        // ä¸Šæ¬¡æ‰¹æ³¨æ—¶é—´æˆ³
  todaySpeakCount: number;      // ä»Šæ—¥æ‰¹æ³¨æ¬¡æ•°
  dailyLimit: number;           // æ¯æ—¥é™é¢ï¼Œé»˜è®¤ 5
  cooldownMs: number;           // å†·å´æ—¶é—´ï¼Œé»˜è®¤ 2å°æ—¶ = 7200000ms
  
  // ä»Šæ—¥ç»Ÿè®¡ï¼ˆç”¨äº AI å†³ç­–å‚è€ƒï¼‰
  todayStats: {
    totalActivities: number;
    totalDuration: number;
    deletedTasks: number;
    lastDeletedAt: number;
  };
}
```

### 3.4 æ‰¹æ³¨å†³ç­–æµç¨‹

```typescript
async function shouldGenerateAnnotation(
  eventType: string,
  eventData: any
): Promise<boolean> {
  const state = getAnnotationState();
  
  // 1. æ£€æŸ¥å†·å´
  const now = Date.now();
  if (now - state.lastSpeakTime < state.cooldownMs) {
    return false;
  }
  
  // 2. æ£€æŸ¥é™é¢
  if (state.todaySpeakCount >= state.dailyLimit) {
    return false;
  }
  
  // 3. è·å–äº‹ä»¶æƒé‡
  const weight = EVENT_WEIGHTS[eventType];
  let probability = weight.base;
  
  // 4. åº”ç”¨åŠ æˆ
  if (weight.bonusConditions) {
    probability += calculateBonus(eventData, weight.bonusConditions);
  }
  
  // 5. é™åˆ¶æœ€å¤§æ¦‚ç‡
  probability = Math.min(probability, weight.max);
  
  // 6. éšæœºå†³ç­–
  return Math.random() * 100 < probability;
}
```

### 3.5 æ‰¹æ³¨ç”Ÿæˆ API

**è¯·æ±‚æ ¼å¼**ï¼š
```typescript
interface AnnotationRequest {
  eventType: string;           // è§¦å‘äº‹ä»¶ç±»å‹
  eventData: any;              // äº‹ä»¶æ•°æ®
  userContext: {
    todayActivities: number;   // ä»Šæ—¥æ´»åŠ¨æ•°
    todayDuration: number;     // ä»Šæ—¥æ€»æ—¶é•¿
    currentTime: string;       // å½“å‰æ—¶é—´ HH:mm
    recentFragments: Array<{   // æœ€è¿‘ç”Ÿæˆçš„ç¢ç‰‡
      shape: string;
      color: string;
      activity: string;
    }>;
  };
  aiPersonality: {
    tone: 'playful' | 'concerned' | 'celebrating';
    reference: string[];       // å¯å¼•ç”¨çš„æ„è±¡
  };
}
```

**å“åº”æ ¼å¼**ï¼š
```typescript
interface AnnotationResponse {
  content: string;             // æ‰¹æ³¨å†…å®¹ï¼Œå¦‚"ğŸŒ™ å‡Œæ™¨1ç‚¹è¿˜åœ¨å†™ä»£ç ï¼Œä½ æ˜¯åœ¨å’Œæœˆçƒé€šè®¯å—"
  tone: string;                // è¯­æ°”æ ‡ç­¾
  displayDuration: number;     // æ˜¾ç¤ºæ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 8000
}
```

### 3.6 æ‰¹æ³¨ UI å±•ç¤º

**è®¾è®¡è¦æ±‚**ï¼š
- ä½ç½®ï¼šå±å¹•å³ä¾§è¾¹ç¼˜ï¼Œè·é¡¶éƒ¨ 20%
- åŠ¨ç”»ï¼šä»å³ä¾§æ»‘å…¥ï¼Œåœç•™ 8 ç§’åæ»‘å‡º
- æ ·å¼ï¼šæ¯›ç»ç’ƒèƒŒæ™¯ï¼Œåœ†è§’ï¼Œå°å¤–æ˜Ÿäººå¤´åƒ
- äº¤äº’ï¼šç‚¹å‡»å¯æå‰å…³é—­ï¼Œæ‚¬åœæš‚åœè®¡æ—¶

```typescript
interface AnnotationUIProps {
  content: string;
  avatar?: string;             // é»˜è®¤ ğŸ‘½
  duration?: number;           // é»˜è®¤ 8000ms
  onClose?: () => void;
}
```

---

## 4ï¸âƒ£ ç”»å»Šç³»ç»Ÿ (Gallery System)

### 4.1 ç»ç’ƒå½©çª—æ•°æ®æ¨¡å‹

```typescript
interface StainedGlass {
  id: string;
  userId: string;
  
  // æ—¶é—´ç»´åº¦
  period: 'daily' | 'weekly' | 'monthly';
  date: string;                // YYYY-MM-DD æˆ– YYYY-WXX æˆ– YYYY-MM
  startDate: string;
  endDate: string;
  
  // ä¸»é¢˜
  themeDescription: string;    // AI ç”Ÿæˆçš„ä¸»é¢˜æè¿°
  themeName: string;           // ä¸»é¢˜åç§°ï¼Œå¦‚"æ˜Ÿç©ºä¸‹çš„çŒ«"
  
  // ç¢ç‰‡å¸ƒå±€
  fragmentLayouts: Array<{
    fragmentId: string;
    position: {
      x: number;               // 0-1 ç›¸å¯¹åæ ‡
      y: number;
    };
    scale: number;             // 0.5-2.0 å¤§å°å€æ•°
    rotation: number;          // 0-360 æ—‹è½¬è§’åº¦
    layer: number;             // å±‚çº§ï¼Œ0 æœ€åº•å±‚
  }>;
  
  // å…ƒæ•°æ®
  summary: string;             // AI ç”Ÿæˆçš„ä¸€å¥è¯æ€»ç»“
  createdAt: number;
}
```

### 4.2 å½©çª—ç”Ÿæˆæµç¨‹

**æ—¥å½©çª—**ï¼š
```
æ—¥ç»ˆï¼ˆæˆ–ç”¨æˆ·ç‚¹å‡»æŸ¥çœ‹æ—¶ï¼‰
    â†“
æ”¶é›†å½“æ—¥æ‰€æœ‰ç¢ç‰‡
    â†“
è°ƒç”¨ AI ç”Ÿæˆä¸»é¢˜æè¿°
    â†“
AI è¿”å›ä¸»é¢˜ï¼ˆå¦‚"åœ¨æš´é£é›¨ä¸­è·³èˆçš„çŒ«"ï¼‰
    â†“
æ ¹æ®ä¸»é¢˜è®¡ç®—ç¢ç‰‡å¸ƒå±€
    â†“
æ¸²æŸ“ SVG å½©çª—
```

**å‘¨/æœˆå½©çª—**ï¼š
```
é€‰æ‹©æŸ¥çœ‹å‘¨/æœˆè§†å›¾
    â†“
è·å–è¯¥æ—¶æ®µæ‰€æœ‰æ—¥å½©çª—
    â†“
è°ƒç”¨ AI ç”Ÿæˆæ–°çš„ä¸»é¢˜
    â†“
AI è¿”å›å‘¨/æœˆä¸»é¢˜
    â†“
å°†æ—¥å½©çª—ä½œä¸º"è¶…çº§ç¢ç‰‡"é‡æ–°å¸ƒå±€
    â†“
æ¸²æŸ“æ–°çš„å½©çª—
```

### 4.3 å½©çª—æ¸²æŸ“æŠ€æœ¯è§„æ ¼

**è§†è§‰è¦æ±‚**ï¼š
- ç”»å¸ƒå°ºå¯¸ï¼šå“åº”å¼ï¼Œæœ€å° 320pxï¼Œæœ€å¤§ 800px
- ç¢ç‰‡å½¢çŠ¶ï¼šSVG pathï¼Œ5 ç§åŸºç¡€å½¢çŠ¶
- é¢œè‰²æ¸²æŸ“ï¼šSVG linearGradient
- è´¨æ„Ÿæ•ˆæœï¼šCSS filterï¼ˆglassmorphismï¼‰
  - backdrop-filter: blur(10px)
  - box-shadow: 0 8px 32px rgba(0,0,0,0.1)
  - border: 1px solid rgba(255,255,255,0.2)
- åŠ¨ç”»ï¼šFramer Motionï¼Œç¢ç‰‡æ”¶é›†æ—¶é£å…¥æ•ˆæœ

**äº¤äº’è¦æ±‚**ï¼š
- ç‚¹å‡»ç¢ç‰‡ï¼šæ˜¾ç¤ºæ´»åŠ¨è¯¦æƒ…å¼¹çª—
- æåˆæ‰‹åŠ¿ï¼šå‘¨/æœˆè§†å›¾ä¸‹å¯æ”¾å¤§æŸ¥çœ‹
- å·¦å³æ»‘åŠ¨ï¼šåˆ‡æ¢æ—¥/å‘¨/æœˆè§†å›¾

### 4.4 å½±å­æ—¥è®°é›†æˆ

**æ•°æ®æ¨¡å‹**ï¼š
```typescript
interface ShadowDiary {
  id: string;
  userId: string;
  date: string;                // æ‰€å±æ—¥æœŸ
  
  // ä¿¡ä»¶å†…å®¹
  letter: {
    greeting: string;          // ç§°å‘¼
    body: string;              // æ­£æ–‡
    highlights: string[];      // ä»Šæ—¥äº®ç‚¹åˆ—è¡¨
    advice: string;            // æ˜æ—¥å»ºè®®
    signature: string;         // ç½²åï¼Œé»˜è®¤"æ¥è‡ªæ—¶é—´æ˜Ÿçƒçš„è§‚å¯Ÿå‘˜"
  };
  
  // å…³è”æ•°æ®
  fragmentCount: number;       // ä»Šæ—¥ç¢ç‰‡æ•°
  glassId: string;             // å…³è”çš„å½©çª— ID
  
  // çŠ¶æ€
  isRead: boolean;             // æ˜¯å¦å·²è¯»
  readAt?: number;
  createdAt: number;
}
```

**å±•ç¤ºç­–ç•¥**ï¼š
- **é¦–æ¬¡å±•ç¤º**ï¼šæ¬¡æ—¥é¦–æ¬¡æ‰“å¼€ App æ—¶ï¼Œå…¨å±å±•ç¤ºæ—¥è®°å¡ç‰‡
- **å†å²æŸ¥çœ‹**ï¼šGallery é¡µé¢ä¸­ï¼Œæ¯ä¸ªå½©çª—å¯ç‚¹å‡»å±•å¼€å¯¹åº”æ—¥è®°
- **æœªè¯»æç¤º**ï¼šGallery å›¾æ ‡ä¸Šæœ‰çº¢ç‚¹æç¤ºæœªè¯»æ—¥è®°æ•°

**æ—¥è®°ç”Ÿæˆ API**ï¼š
```typescript
interface DiaryGenerationRequest {
  date: string;
  fragments: TimeFragment[];
  activities: Message[];
  dayStats: {
    totalDuration: number;
    activityCount: number;
    moodKeywords: string[];
  };
}

interface DiaryGenerationResponse {
  greeting: string;
  body: string;
  highlights: string[];
  advice: string;
  themeDescription: string;    // åŒæ­¥ç”Ÿæˆå½©çª—ä¸»é¢˜
}
```

---

## 5ï¸âƒ£ ç”¨æˆ·ç•Œé¢ (User Interface)

### 5.1 é¡µé¢ç»“æ„

```
App
â”œâ”€â”€ /chat                    # å¯¹è¯/è®°å½•é¡µé¢ï¼ˆå·²æœ‰ï¼Œéœ€æ”¹é€ ï¼‰
â”‚   â”œâ”€â”€ Mode Switcher        # å¯¹è¯/è®°å½•æ¨¡å¼åˆ‡æ¢
â”‚   â”œâ”€â”€ Message List         # æ¶ˆæ¯/æ´»åŠ¨åˆ—è¡¨
â”‚   â”œâ”€â”€ Input Area           # è¾“å…¥æ¡†
â”‚   â””â”€â”€ AI Annotation Layer  # æ‰¹æ³¨æµ®å±‚ï¼ˆæ–°å¢ï¼‰
â”‚
â”œâ”€â”€ /todo                    # å¾…åŠé¡µé¢ï¼ˆå·²æœ‰ï¼Œéœ€å¾®è°ƒï¼‰
â”‚   â”œâ”€â”€ Quick Action Card    # ç½®é¡¶å¿«æ·å…¥å£ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ Filter Tabs          # æ—¥/å‘¨/æœˆç­›é€‰
â”‚   â”œâ”€â”€ Todo List            # å¾…åŠåˆ—è¡¨
â”‚   â””â”€â”€ Add Button           # æ·»åŠ æŒ‰é’®
â”‚
â”œâ”€â”€ /gallery                 # æ—¶å…‰ç”»å»Šï¼ˆæ–°å»ºï¼‰
â”‚   â”œâ”€â”€ Daily View           # æ—¥å½©çª—
â”‚   â”œâ”€â”€ Weekly View          # å‘¨å½©çª—
â”‚   â”œâ”€â”€ Monthly View         # æœˆå½©çª—
â”‚   â”œâ”€â”€ Shadow Diary Card    # å½±å­æ—¥è®°
â”‚   â””â”€â”€ Timeline Navigator   # æ—¶é—´è½´å¯¼èˆª
â”‚
â””â”€â”€ /report                  # æŠ¥å‘Šé¡µé¢ï¼ˆå·²æœ‰ï¼Œæ•´åˆï¼‰
    â”œâ”€â”€ Calendar View        # æ—¥å†è§†å›¾
    â”œâ”€â”€ Report Detail        # æŠ¥å‘Šè¯¦æƒ…
    â””â”€â”€ Glass Integration    # ç‚¹å‡»æ—¥æœŸæŸ¥çœ‹å½©çª—ï¼ˆæ–°å¢ï¼‰
```

### 5.2 å¯¼èˆªç»“æ„

**åº•éƒ¨å¯¼èˆªæ **ï¼ˆå·²æœ‰ï¼‰ï¼š
- å¯¹è¯è®°å½•ï¼ˆ/chatï¼‰- å›¾æ ‡ï¼šMessageSquare
- å¾…åŠç®¡ç†ï¼ˆ/todoï¼‰- å›¾æ ‡ï¼šCheckSquare
- æ—¶å…‰ç”»å»Šï¼ˆ/galleryï¼‰- å›¾æ ‡ï¼šSparklesï¼ˆæ–°å¢ï¼‰
- æ—¶é—´æŠ¥å‘Šï¼ˆ/reportï¼‰- å›¾æ ‡ï¼šPieChart

---

## 6ï¸âƒ£ æŠ€æœ¯è§„æ ¼

### 6.1 æŠ€æœ¯æ ˆï¼ˆå·²æœ‰ï¼‰

- **æ¡†æ¶**ï¼šReact 18 + TypeScript
- **æ„å»º**ï¼šVite 7.0
- **æ ·å¼**ï¼šTailwind CSS 3.4
- **çŠ¶æ€**ï¼šZustand + persist
- **è·¯ç”±**ï¼šReact Router 6
- **åŠ¨ç”»**ï¼šFramer Motion
- **åç«¯**ï¼šSupabaseï¼ˆå¯é€‰ï¼‰
- **AI API**ï¼šç”¨æˆ·è‡ªæœ‰ API

### 6.2 æ–°å¢ä¾èµ–å»ºè®®

```json
{
  "dependencies": {
    "react-calendar": "^6.0.0",      // å·²æœ‰ï¼Œç”¨äºæŠ¥å‘Šé¡µ
    "date-fns": "^4.1.0",            // å·²æœ‰ï¼Œæ—¥æœŸå¤„ç†
    "framer-motion": "^11.0.8"       // å·²æœ‰ï¼ŒåŠ¨ç”»
  }
}
```

### 6.3 æ–‡ä»¶ç»“æ„ï¼ˆæ–°å¢ï¼‰

```
src/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ ai.ts                      # AI API å°è£…
â”‚
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ aiAnnotator.ts             # AI æ‰¹æ³¨æœåŠ¡
â”‚   â”œâ”€â”€ fragmentGenerator.ts       # ç¢ç‰‡ç”ŸæˆæœåŠ¡
â”‚   â”œâ”€â”€ glassGenerator.ts          # å½©çª—ç”ŸæˆæœåŠ¡
â”‚   â””â”€â”€ shadowDiary.ts             # å½±å­æ—¥è®°æœåŠ¡
â”‚
â”œâ”€â”€ store/
â”‚   â”œâ”€â”€ useFragmentStore.ts        # ç¢ç‰‡çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ useAnnotationStore.ts      # æ‰¹æ³¨çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ useGalleryStore.ts         # ç”»å»ŠçŠ¶æ€ç®¡ç†
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ fragments/                 # ç¢ç‰‡ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ SpiralFragment.tsx
â”‚   â”‚   â”œâ”€â”€ ArrowFragment.tsx
â”‚   â”‚   â”œâ”€â”€ SparkFragment.tsx
â”‚   â”‚   â”œâ”€â”€ WaveFragment.tsx
â”‚   â”‚   â””â”€â”€ CrystalFragment.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ AIAnnotationBubble.tsx     # æ‰¹æ³¨æ°”æ³¡
â”‚   â”œâ”€â”€ QuickActionCard.tsx        # å¿«æ·å…¥å£å¡ç‰‡
â”‚   â”œâ”€â”€ StainedGlass.tsx           # å½©çª—ç»„ä»¶
â”‚   â”œâ”€â”€ ShadowDiaryCard.tsx        # æ—¥è®°å¡ç‰‡
â”‚   â””â”€â”€ FragmentDetailModal.tsx    # ç¢ç‰‡è¯¦æƒ…
â”‚
â”œâ”€â”€ features/
â”‚   â””â”€â”€ gallery/
â”‚       â”œâ”€â”€ GalleryPage.tsx
â”‚       â”œâ”€â”€ DailyView.tsx
â”‚       â”œâ”€â”€ WeeklyView.tsx
â”‚       â””â”€â”€ MonthlyView.tsx
â”‚
â””â”€â”€ types/
    â””â”€â”€ fragment.ts                # ç±»å‹å®šä¹‰
```

---

## 7ï¸âƒ£ å¼€å‘è·¯çº¿å›¾

### Phase 1ï¼šåŸºç¡€æ¶æ„ï¼ˆWeek 1-2ï¼‰

**Week 1ï¼šæ•°æ®å±‚**
- [ ] åˆ›å»º Fragment ç±»å‹å®šä¹‰
- [ ] åˆ›å»º FragmentStore
- [ ] ä¿®æ”¹ ChatStoreï¼Œæ·»åŠ ç¢ç‰‡ç”Ÿæˆè§¦å‘
- [ ] åˆ›å»º AI æœåŠ¡å±‚å°è£…

**Week 2ï¼šAI æ‰¹æ³¨**
- [ ] åˆ›å»º AIAnnotator æœåŠ¡
- [ ] å®ç°äº‹ä»¶ç›‘å¬æœºåˆ¶
- [ ] åˆ›å»ºæ‰¹æ³¨çŠ¶æ€ç®¡ç†
- [ ] åˆ›å»º AnnotationBubble ç»„ä»¶

### Phase 2ï¼šè§†è§‰ç³»ç»Ÿï¼ˆWeek 3-4ï¼‰

**Week 3ï¼šç¢ç‰‡æ¸²æŸ“**
- [ ] åˆ›å»º 5 ç§ SVG ç¢ç‰‡å½¢çŠ¶
- [ ] å®ç°ç¢ç‰‡æ ·å¼ç³»ç»Ÿï¼ˆé¢œè‰²/è´¨æ„Ÿ/æ¸©åº¦ï¼‰
- [ ] åˆ›å»ºç¢ç‰‡æ”¶é›†åŠ¨ç”»

**Week 4ï¼šå½©çª—å¼•æ“**
- [ ] å®ç°æ—¥å½©çª—å¸ƒå±€ç®—æ³•
- [ ] åˆ›å»º StainedGlass ç»„ä»¶
- [ ] å®ç° SVG æ¸²æŸ“å¼•æ“

### Phase 3ï¼šç”»å»Šç³»ç»Ÿï¼ˆWeek 5-6ï¼‰

**Week 5ï¼šç”»å»Šé¡µé¢**
- [ ] åˆ›å»º GalleryPage
- [ ] å®ç°æ—¥/å‘¨/æœˆè§†å›¾åˆ‡æ¢
- [ ] å®ç°æ—¶é—´è½´å¯¼èˆª

**Week 6ï¼šå½±å­æ—¥è®°**
- [ ] åˆ›å»ºæ—¥è®°ç”ŸæˆæœåŠ¡
- [ ] åˆ›å»º ShadowDiaryCard ç»„ä»¶
- [ ] å®ç°é¦–æ¬¡å±•ç¤ºé€»è¾‘

### Phase 4ï¼šæ•´åˆä¼˜åŒ–ï¼ˆWeek 7-8ï¼‰

**Week 7ï¼šåŠŸèƒ½æ•´åˆ**
- [ ] æ•´åˆ Report é¡µé¢ä¸å½©çª—
- [ ] æ·»åŠ å½©çª—åˆ†äº«åŠŸèƒ½
- [ ] ä¼˜åŒ–åŠ¨ç”»æ€§èƒ½

**Week 8ï¼šæµ‹è¯•ä¼˜åŒ–**
- [ ] å…¨é¢æµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] Bug ä¿®å¤

---

## 8ï¸âƒ£ éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

| åŠŸèƒ½ | éªŒæ”¶æ ‡å‡† |
|------|---------|
| æ´»åŠ¨è®°å½• | è®°å½•æ´»åŠ¨åè‡ªåŠ¨ç”Ÿæˆç¢ç‰‡æ•°æ® |
| AI æ‰¹æ³¨ | è§¦å‘äº‹ä»¶åï¼ŒæŒ‰æ¦‚ç‡æ­£ç¡®æ˜¾ç¤ºæ‰¹æ³¨æ°”æ³¡ |
| å†·å´æœºåˆ¶ | 2 å°æ—¶å†…ä¸é‡å¤è§¦å‘ï¼Œæ¯æ—¥æœ€å¤š 5 æ¬¡ |
| æ—¥å½©çª— | æ­£ç¡®æ¸²æŸ“æ‰€æœ‰ç¢ç‰‡ï¼Œç‚¹å‡»å¯æŸ¥çœ‹è¯¦æƒ… |
| å½±å­æ—¥è®° | æ¬¡æ—¥é¦–æ¬¡æ‰“å¼€æ­£ç¡®å±•ç¤ºï¼Œå¯å›çœ‹å†å² |

### æ€§èƒ½æŒ‡æ ‡

- é¦–æ¬¡åŠ è½½ < 3 ç§’
- ç¢ç‰‡ç”Ÿæˆ < 1 ç§’ï¼ˆè°ƒç”¨ AI APIï¼‰
- å½©çª—æ¸²æŸ“ < 500ms
- æ‰¹æ³¨åŠ¨ç”»æµç•…ï¼Œä¸å¡é¡¿

---

## 9ï¸âƒ£ é™„å½•

### 9.1 å‘½åè§„èŒƒ

- **ç»„ä»¶**ï¼šPascalCaseï¼Œå¦‚ `StainedGlass.tsx`
- **æœåŠ¡**ï¼šcamelCaseï¼Œå¦‚ `aiAnnotator.ts`
- **Store**ï¼šuse + PascalCaseï¼Œå¦‚ `useFragmentStore.ts`
- **ç±»å‹**ï¼šPascalCaseï¼Œå¦‚ `TimeFragment`

### 9.2 é¢œè‰²å‚è€ƒ

```css
/* ç»ç’ƒè´¨æ„Ÿ */
--glass-bg: rgba(255, 255, 255, 0.25);
--glass-border: rgba(255, 255, 255, 0.3);
--glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);

/* æ¸©åº¦è‰²æ¿ */
--temp-cool: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
--temp-warm: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
--temp-hot: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
--temp-electric: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
```

### 9.3 å‚è€ƒèµ„æº

- ç»ç’ƒæ‹Ÿæ€è®¾è®¡ï¼šhttps://glassmorphism.com/
- SVG è·¯å¾„ç”Ÿæˆï¼šhttps://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths
- Framer Motionï¼šhttps://www.framer.com/motion/

---

*æ–‡æ¡£ç»“æŸ*
